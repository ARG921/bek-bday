<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Birthify Bebek</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Satisfy&family=DM+Sans:wght@400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
:root{--sg:#1DB954;--sb:#121212;--sd:#181818;--sl:#b3b3b3;--sw:#fff}
body{font-family:'DM Sans',sans-serif;background:var(--sb);color:var(--sw);height:100dvh;overflow:hidden}

/* ===== PLAYER SCREEN - FIXED LAYOUT ===== */
.player-screen{
  display:flex;flex-direction:column;align-items:center;
  height:100dvh;
  padding:0 28px;
  background:linear-gradient(180deg,#2a4a6b 0%,#1a2a3a 35%,var(--sb) 70%);
  transition:opacity .5s,transform .5s;
  position:relative;z-index:10;
  overflow:hidden;
}
.player-screen.hidden{opacity:0;transform:scale(.95);pointer-events:none;position:absolute;top:0;left:0;right:0}

.top-bar{
  display:flex;justify-content:space-between;align-items:center;
  width:100%;max-width:420px;
  padding:16px 0 8px;
  flex-shrink:0;
}
.top-bar svg{cursor:pointer;opacity:.7}

/* Album takes up flexible space */
.album-container{
  width:100%;max-width:420px;
  flex:1 1 auto;
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;
  min-height:0;
  padding:4px 0;
}
.album-inner{
  width:100%;
  max-width:min(85vw, 380px);
  aspect-ratio:1;
  position:relative;
}
.album-art{
  width:100%;height:100%;
  border-radius:8px;
  box-shadow:0 8px 40px rgba(0,0,0,.5);
  overflow:hidden;
  transition:transform .3s;
}
.album-art:active{transform:scale(.97)}
.album-art img{width:100%;height:100%;object-fit:cover;display:block;border-radius:8px}

.tap-hint{
  font-size:11px;color:var(--sl);opacity:.5;
  text-align:center;
  margin-top:2px;
  flex-shrink:0;
  animation:ph 2s ease-in-out infinite;
}
@keyframes ph{0%,100%{opacity:.3}50%{opacity:.6}}

/* Bottom section - fixed height, no stretch */
.bottom-section{
  width:100%;max-width:420px;
  flex-shrink:0;
  padding-bottom:max(16px, env(safe-area-inset-bottom));
}

.lyrics-section{
  width:100%;height:68px;
  overflow:hidden;position:relative;
  margin-bottom:8px;
}
.lyrics-section::before,.lyrics-section::after{content:'';position:absolute;left:0;right:0;height:16px;z-index:2;pointer-events:none}
.lyrics-section::before{top:0;background:linear-gradient(180deg,rgba(18,18,18,.7),transparent)}
.lyrics-section::after{bottom:0;background:linear-gradient(0deg,rgba(18,18,18,.7),transparent)}
.lyrics-track{transition:transform .4s cubic-bezier(.25,.1,.25,1);padding-top:22px}
.lyric-line{font-size:14px;font-weight:700;color:rgba(255,255,255,.22);padding:2px 0;transition:color .35s,transform .35s;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;line-height:1.45}
.lyric-line.active{color:var(--sw);transform:scale(1.02);transform-origin:left center}
.lyric-line.passed{color:rgba(255,255,255,.32)}

.song-info{width:100%;margin-bottom:10px}
.song-title{font-size:19px;font-weight:700;margin-bottom:1px}
.song-artist{font-size:13px;color:var(--sl)}
.song-title-row{display:flex;justify-content:space-between;align-items:center}
.liked-icon{width:26px;height:26px;background:var(--sg);border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.liked-icon svg{width:14px;height:14px}

.progress-section{width:100%;margin-bottom:8px}
.progress-bar-bg{width:100%;height:4px;background:#404040;border-radius:2px;cursor:pointer;position:relative}
.progress-bar-fill{height:100%;background:var(--sw);border-radius:2px;width:0%;position:relative}
.progress-bar-fill::after{content:'';position:absolute;right:-6px;top:-4px;width:12px;height:12px;background:white;border-radius:50%;opacity:0;transition:opacity .2s}
.progress-bar-bg:hover .progress-bar-fill::after,.progress-bar-bg:active .progress-bar-fill::after{opacity:1}
.progress-bar-bg:hover .progress-bar-fill{background:var(--sg)}
.progress-times{display:flex;justify-content:space-between;margin-top:4px;font-size:11px;color:var(--sl)}

.controls{
  display:flex;align-items:center;justify-content:space-between;
  width:100%;max-width:300px;
  margin:0 auto;
  padding:4px 0;
}
.controls svg{cursor:pointer;fill:var(--sl);transition:fill .2s,transform .15s}
.controls svg:hover{fill:white}
.controls svg:active{transform:scale(.9)}
.play-btn{width:56px;height:56px;background:white;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:transform .15s}
.play-btn:hover{transform:scale(1.06)}
.play-btn:active{transform:scale(.95)}
.play-btn svg{fill:black!important}

/* ===== BIRTHDAY SCREEN ===== */
.birthday-screen{position:fixed;top:0;left:0;right:0;bottom:0;background:var(--sb);z-index:20;opacity:0;transform:scale(1.05);pointer-events:none;transition:opacity .5s,transform .5s;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch}
.birthday-screen.active{opacity:1;transform:scale(1);pointer-events:all}
.birthday-inner{min-height:100%;padding:0 24px 60px;max-width:480px;margin:0 auto}
.bday-back{position:sticky;top:0;background:linear-gradient(180deg,var(--sb) 60%,transparent);padding:16px 0;z-index:30;display:flex;align-items:center;gap:12px;cursor:pointer}
.bday-back span{font-size:14px;font-weight:600;color:var(--sl)}
.bday-header{text-align:center;padding:20px 0 30px}
.bday-header .greeting-top{font-family:'Satisfy',cursive;font-size:22px;color:var(--sg);margin-bottom:4px}
.bday-header h1{font-family:'Playfair Display',serif;font-size:42px;font-weight:700;background:linear-gradient(135deg,#1DB954,#1ed760,#a8e6cf);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;line-height:1.1;margin-bottom:6px}
.bday-header .bday-name{font-family:'Satisfy',cursive;font-size:52px;color:#f0c8a0;text-shadow:0 0 30px rgba(240,200,160,.3)}
.bday-header .bday-sub{font-size:14px;color:var(--sl);margin-top:8px}
#confetti-canvas{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:25}
.message-card{background:var(--sd);border-radius:12px;padding:24px;margin-bottom:16px;border:1px solid rgba(255,255,255,.05);opacity:0;transform:translateY(30px);transition:opacity .6s,transform .6s;position:relative;overflow:hidden}
.message-card.visible{opacity:1;transform:translateY(0)}
.message-card::before{content:'';position:absolute;top:0;left:0;width:4px;height:100%;border-radius:4px 0 0 4px}
.message-card .card-emoji{font-size:32px;margin-bottom:12px;display:block}
.message-card h3{font-family:'Playfair Display',serif;font-size:20px;font-weight:700;margin-bottom:10px}
.message-card p{font-size:15px;line-height:1.7;color:var(--sl)}
.card-accent-1::before{background:linear-gradient(180deg,#1DB954,#1ed760)}
.card-accent-2::before{background:linear-gradient(180deg,#f0c8a0,#e8a870)}
.card-accent-3::before{background:linear-gradient(180deg,#e8a8b0,#d88090)}
.card-accent-4::before{background:linear-gradient(180deg,#7eb8da,#5a98ba)}
.card-accent-5::before{background:linear-gradient(180deg,#c8a8e8,#a888c8)}
.final-section{text-align:center;padding:40px 0 20px;opacity:0;transform:translateY(30px);transition:opacity .8s ease .2s,transform .8s ease .2s}
.final-section.visible{opacity:1;transform:translateY(0)}
.final-section .cake-emoji{font-size:64px;display:block;margin-bottom:16px;animation:fc 3s ease-in-out infinite}
@keyframes fc{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
.final-section h2{font-family:'Satisfy',cursive;font-size:36px;color:var(--sg);margin-bottom:12px}
.final-section p{color:var(--sl);font-size:15px;line-height:1.6}
.final-section .signature{margin-top:24px;font-style:italic;color:#f0c8a0;font-size:16px}
.equalizer{display:flex;align-items:flex-end;gap:3px;height:20px;margin:20px auto 0;width:fit-content}
.eq-bar{width:4px;background:var(--sg);border-radius:2px;animation:eb 1s ease-in-out infinite}
.eq-bar:nth-child(1){height:8px;animation-delay:0s}
.eq-bar:nth-child(2){height:16px;animation-delay:.15s}
.eq-bar:nth-child(3){height:10px;animation-delay:.3s}
.eq-bar:nth-child(4){height:18px;animation-delay:.1s}
.eq-bar:nth-child(5){height:6px;animation-delay:.25s}
@keyframes eb{0%,100%{transform:scaleY(.3)}50%{transform:scaleY(1)}}

/* Small phones */
@media(max-height:640px){
  .album-inner{max-width:min(65vw,260px)}
  .lyrics-section{height:54px}
  .lyric-line{font-size:12px}
  .play-btn{width:48px;height:48px}
  .song-title{font-size:17px}
}
@media(max-width:380px){
  .bday-header h1{font-size:34px}
  .bday-header .bday-name{font-size:42px}
}
</style>
</head>
<body>
<audio id="audioPlayer" preload="auto" src="young-dumb-broke.mp3"></audio>

<div class="player-screen" id="playerScreen">
  <div class="top-bar">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
    <span style="font-size:12px;font-weight:600;color:var(--sl);text-transform:uppercase;letter-spacing:1px">Playing from playlist</span>
    <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><circle cx="12" cy="5" r="2"/><circle cx="12" cy="12" r="2"/><circle cx="12" cy="19" r="2"/></svg>
  </div>

  <div class="album-container" onclick="openBirthday()">
    <div class="album-inner">
      <div class="album-art">
        <img src="album-cover.jpg" alt="Asian Teen - Hanssen">
      </div>
    </div>
  </div>
  <div class="tap-hint">Tap the album cover</div>

  <div class="bottom-section">
    <div class="lyrics-section">
      <div class="lyrics-track" id="lyricsTrack"></div>
    </div>

    <div class="song-info">
      <div class="song-title-row">
        <div>
          <div class="song-title">Young Dumb & Broke</div>
          <div class="song-artist">Khalid</div>
        </div>
      </div>
    </div>

    <div class="progress-section">
      <div class="progress-bar-bg" id="progressBar">
        <div class="progress-bar-fill" id="progressFill"></div>
      </div>
      <div class="progress-times">
        <span id="currentTime">0:00</span>
        <span id="remainTime">-3:22</span>
      </div>
    </div>

    <div class="controls">
      <svg width="22" height="22" viewBox="0 0 24 24"><path d="M10.59 9.17L5.41 4 4 5.41l5.17 5.17 1.42-1.41zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4h-5.5zm.33 9.41l-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04-3.13-3.13z"/></svg>
      <svg width="28" height="28" viewBox="0 0 24 24" onclick="skipBack()"><path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/></svg>
      <div class="play-btn" onclick="togglePlay()">
        <svg id="playIcon" width="26" height="26" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
      </div>
      <svg width="28" height="28" viewBox="0 0 24 24" onclick="skipForward()"><path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/></svg>
      <svg width="22" height="22" viewBox="0 0 24 24"><path d="M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"/></svg>
    </div>
  </div>
</div>

<canvas id="confetti-canvas"></canvas>
<div class="birthday-screen" id="birthdayScreen">
  <div class="birthday-inner">
    <div class="bday-back" onclick="closeBirthday()">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
      <span>Back to Player</span>
    </div>
    <div class="bday-header">
      <div class="greeting-top">üéµ Lagu Lo Beut Dah Ini üéµ</div>
      <h1>Happy Birthday</h1>
      <div class="bday-name">BEBEK!</div>
      <div class="bday-sub">Today the playlist is all about you üéß</div>
      <div class="equalizer"><div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div><div class="eq-bar"></div></div>
    </div>
    <div class="message-card card-accent-1" data-delay="0">
      <span class="card-emoji">üéÇ</span>
      <h3>Another Year, Another Chapter</h3>
      <p>Selamat ulang tahun, BEBEK! Semoga di tahun yang baru ini, semua hal-hal baik datang menghampiri lu. Lu layak dapat yang terbaik, brader!</p>
    </div>
    <div class="message-card card-accent-2" data-delay="100">
      <span class="card-emoji">üåü</span>
      <h3>Keep Shining, Pookie</h3>
      <p>Semoga pantat lu aman dari Bintang dan semoga lu bisa jadi versi terbaik dari diri lu!</p>
    </div>
    <div class="message-card card-accent-3" data-delay="200">
      <span class="card-emoji">üçª</span>
      <h3>LEVEEELLLL UPPP</h3>
      <p>pibesdeeyy bebeeekk, panjang umur, sehat selalu, sukses terus, bahagia selalu, jangan sibuk" terus, jauhi dunia korporat, bersantai coz u deserve itt, semoga bertemu wanita (bukan pria) tambatan hati, cheers to many more happiness, journey, and adventure üçª keep shinin
<br><br> 
- memmoiiii üçªüçª</p>
    </div>
    <div class="message-card card-accent-4" data-delay="300">
      <span class="card-emoji">ü•Ç</span>
      <h3>good news is: you survive the 24 chapter!</h3>
      <p>happy 25th birthday bebek! wishing you aaalllll the very222 best and i hope quarter life doesn't hit you too hard. but if it does, it‚Äôs okay to say ‚Äúscrew thissüí©üöΩ‚Äù atau ‚Äúfuck lifee‚Äù senyamannya lu aja deh
<br><br>
semoga di umur yang baru, kerjaan bisa lebih baik ke lu, sibuknya lebih bisa berkurang dan lu lebih bisa menikmati hidup dan waktu yang lu punya (tanpa harus mikirin kerja). semoga cape dan sibuknya lu terbayarkan dengan wishlish lu tercapai dan jangan lupa bahagia! (stop pervertüôèüèª), pokoknya yg terbaik okaayyüê•üê•üê£üê£üê£
<br><br>
-jeve</p>
    </div>
    <div class="final-section" id="finalSection">
      <span class="cake-emoji">üéâ</span>
      <h2>Cheers to you, Bek!</h2>
      <p>Semoga panjang umur, sehat selalu dan dikelilingi orang-orang yang sayang sama lu. Happy birthday once again!</p>
      <div class="signature">‚Äî Cheers, from Aceng, Memoi, Jepe, Bacang, Via</div>
    </div>
  </div>
</div>

<script>
const L=[
{t:0,s:"\u266a  \u266a  \u266a"},
{t:7.31,s:"So you're still thinking of me"},
{t:10.82,s:"Just like I know you should"},
{t:14.31,s:"I cannot give you everything"},
{t:17.94,s:"You know I wish I could"},
{t:21.33,s:"I'm so high at the moment"},
{t:24.82,s:"I'm so caught up in this"},
{t:28.37,s:"Yeah, we're just young, dumb and broke"},
{t:31.63,s:"But we still got love to give"},
{t:34.49,s:"While we're young dumb"},
{t:36.04,s:"Young, young dumb and broke"},
{t:38.46,s:"Young dumb"},
{t:39.49,s:"Young, young dumb and broke"},
{t:41.98,s:"Young dumb"},
{t:43.05,s:"Young, young dumb and broke"},
{t:45.85,s:"Young dumb broke high school kids"},
{t:49.02,s:"Ya-da-da-da-da-da-da-da"},
{t:52.40,s:"Ya-da-da-da-da-da-da"},
{t:56.09,s:"Ya-da-da-da-da-da-da-da"},
{t:59.88,s:"Young dumb broke high school kids"},
{t:63.35,s:"We have so much in common"},
{t:66.93,s:"We argue all the time"},
{t:70.42,s:"You always say I'm wrong"},
{t:74.00,s:"I'm pretty sure I'm right"},
{t:77.41,s:"What's fun about commitment?"},
{t:80.70,s:"When we have our life to live"},
{t:84.36,s:"Yeah, we're just young, dumb and broke"},
{t:87.71,s:"But we still got love to give"},
{t:90.60,s:"While we're young dumb"},
{t:92.09,s:"Young, young dumb and broke"},
{t:94.51,s:"Young dumb"},
{t:95.58,s:"Young, young dumb and broke"},
{t:98.00,s:"Young dumb"},
{t:99.08,s:"Young, young dumb and broke"},
{t:101.89,s:"Young dumb broke high school kids"},
{t:105.00,s:"Ya-da-da-da-da-da-da-da"},
{t:108.47,s:"Ya-da-da-da-da-da-da"},
{t:112.04,s:"Ya-da-da-da-da-da-da-da"},
{t:115.87,s:"Young dumb broke high school kids"},
{t:118.98,s:"Jump and we think"},
{t:120.52,s:"Leave it all in the game of love"},
{t:124.12,s:"Love"},
{t:125.86,s:"Run into sin"},
{t:127.57,s:"Do it all in the name of fun"},
{t:130.76,s:"Fun"},
{t:132.49,s:"Whoa-oa-oa"},
{t:133.58,s:"I'm so high at the moment"},
{t:136.85,s:"I'm so caught up in this"},
{t:140.66,s:"Yeah, we're just young, dumb and broke"},
{t:143.93,s:"But we still got love to give"},
{t:146.96,s:"While we're young dumb"},
{t:148.61,s:"Young, young dumb and broke"},
{t:150.89,s:"Young dumb"},
{t:151.89,s:"Young, young dumb and broke"},
{t:154.15,s:"Young dumb"},
{t:155.36,s:"Young, young dumb and broke"},
{t:157.97,s:"Young dumb broke high school kids"},
{t:161.00,s:"Ya-da-da-da-da-da-da-da"},
{t:164.47,s:"Ya-da-da-da-da-da-da"},
{t:168.04,s:"Ya-da-da-da-da-da-da-da"},
{t:171.95,s:"Young dumb broke high school kids"},
{t:175.00,s:"Ya-da-da-da-da-da-da-da"},
{t:178.47,s:"Ya-da-da-da-da-da-da"},
{t:182.04,s:"Ya-da-da-da-da-da-da-da"},
{t:185.95,s:"Young dumb broke high school kids"},
{t:195.00,s:"\u266a  \u266a  \u266a"}
];

const DUR=202;
let playing=false,cIdx=-1,hasAud=true,simT=0,simI=null;
const aud=document.getElementById('audioPlayer');
const trk=document.getElementById('lyricsTrack');

L.forEach(l=>{const d=document.createElement('div');d.className='lyric-line';d.textContent=l.s;trk.appendChild(d)});

aud.addEventListener('timeupdate',()=>{if(!hasAud)return;upLyr(aud.currentTime);upProg(aud.currentTime,aud.duration||DUR)});
aud.addEventListener('ended',()=>{playing=false;upIcon()});
aud.addEventListener('error',()=>{hasAud=false});

function startSim(){if(simI)return;simI=setInterval(()=>{simT+=.2;if(simT>=DUR){simT=0;playing=false;upIcon();clearInterval(simI);simI=null;resetLyr();return}upLyr(simT);upProg(simT,DUR)},200)}
function stopSim(){if(simI){clearInterval(simI);simI=null}}

function upLyr(ct){
  let ni=-1;
  for(let i=L.length-1;i>=0;i--){if(ct>=L[i].t){ni=i;break}}
  if(ni===cIdx)return;cIdx=ni;
  const ls=trk.children;
  for(let i=0;i<ls.length;i++){ls[i].classList.remove('active','passed');if(i===ni)ls[i].classList.add('active');else if(i<ni)ls[i].classList.add('passed')}
  if(ni>=0){const lh=ls[0].offsetHeight;trk.style.transform='translateY(-'+ni*lh+'px)'}
}
function resetLyr(){cIdx=-1;const ls=trk.children;for(let i=0;i<ls.length;i++)ls[i].classList.remove('active','passed');trk.style.transform='translateY(0)';upProg(0,DUR)}

function upProg(c,d){
  document.getElementById('progressFill').style.width=(c/d*100)+'%';
  document.getElementById('currentTime').textContent=fmt(c);
  document.getElementById('remainTime').textContent='-'+fmt(d-c);
}
function fmt(s){const m=Math.floor(s/60),sc=Math.floor(s%60);return m+':'+(sc<10?'0':'')+sc}

document.getElementById('progressBar').addEventListener('click',function(e){
  const p=(e.clientX-this.getBoundingClientRect().left)/this.offsetWidth;
  if(hasAud){aud.currentTime=p*(aud.duration||DUR)}else{simT=p*DUR;upLyr(simT);upProg(simT,DUR)}
});

function togglePlay(){
  playing=!playing;upIcon();
  if(hasAud){playing?aud.play().catch(()=>{}):aud.pause()}
  else{playing?startSim():stopSim()}
}
function upIcon(){
  const i=document.getElementById('playIcon');
  i.innerHTML=playing?'<rect x="6" y="4" width="4" height="16" rx="1"/><rect x="14" y="4" width="4" height="16" rx="1"/>':'<path d="M8 5v14l11-7z"/>';
}
function skipBack(){if(hasAud)aud.currentTime=Math.max(0,aud.currentTime-10);else{simT=Math.max(0,simT-10);upLyr(simT);upProg(simT,DUR)}}
function skipForward(){if(hasAud)aud.currentTime=Math.min(aud.duration||DUR,aud.currentTime+10);else{simT=Math.min(DUR,simT+10);upLyr(simT);upProg(simT,DUR)}}

function openBirthday(){document.getElementById('birthdayScreen').classList.add('active');document.getElementById('playerScreen').classList.add('hidden');launchConfetti();setTimeout(obsCards,300)}
function closeBirthday(){document.getElementById('birthdayScreen').classList.remove('active');document.getElementById('playerScreen').classList.remove('hidden')}

function obsCards(){
  const cards=document.querySelectorAll('.message-card,.final-section');
  const obs=new IntersectionObserver(es=>{es.forEach(e=>{if(e.isIntersecting){const d=e.target.dataset.delay||0;setTimeout(()=>e.target.classList.add('visible'),d)}})},{threshold:.15,root:document.getElementById('birthdayScreen')});
  cards.forEach(c=>obs.observe(c));
}

function launchConfetti(){
  const cv=document.getElementById('confetti-canvas'),cx=cv.getContext('2d');
  cv.width=innerWidth;cv.height=innerHeight;
  const cols=['#1DB954','#f0c8a0','#e8a8b0','#7eb8da','#fff','#1ed760','#ff6b6b','#ffd93d'];
  const ps=[];
  for(let i=0;i<120;i++)ps.push({x:Math.random()*cv.width,y:Math.random()*cv.height-cv.height,w:Math.random()*10+4,h:Math.random()*6+3,c:cols[Math.floor(Math.random()*cols.length)],sp:Math.random()*3+2,a:Math.random()*Math.PI*2,sn:(Math.random()-.5)*.1,dr:(Math.random()-.5)*1.5,o:1});
  let fr=0;
  function anim(){
    cx.clearRect(0,0,cv.width,cv.height);fr++;
    ps.forEach(p=>{p.y+=p.sp;p.x+=p.dr+Math.sin(p.a)*.5;p.a+=p.sn;if(fr>120)p.o-=.008;cx.save();cx.translate(p.x,p.y);cx.rotate(p.a);cx.globalAlpha=Math.max(0,p.o);cx.fillStyle=p.c;cx.fillRect(-p.w/2,-p.h/2,p.w,p.h);cx.restore()});
    if(fr<300&&ps.some(p=>p.o>0))requestAnimationFrame(anim);else cx.clearRect(0,0,cv.width,cv.height);
  }
  anim();
}

addEventListener('resize',()=>{const c=document.getElementById('confetti-canvas');c.width=innerWidth;c.height=innerHeight});
upProg(0,DUR);
</script>
</body>
</html>